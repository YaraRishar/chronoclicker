# chronoclicker
Chronoclicker - это автокликер для вара, использующий в основном Selenium WebDriver. На данный момент (v1.4) кликер умеет: качать активность, УН, КУ, ПУ, т. е. ходить по локациям по маршруту и выполнять любые действия. Также умеет играть в числа с Лапом, искать предметы (включая звёздную пыль), искать котов (включая ботов СЛ), закапывать предметы, писать в чат, искать путь от клетки до клетки и прочее.

С версии 1.4 можно программировать!

github: https://github.com/YaraRishar/chronoclicker
vk: https://vk.com/chronoclicker
####
**НИГДЕ БОЛЬШЕ** кликер не выкладывается.

Также есть отдельная программа, умеющая только играть в числа с Лапом (работает без комманд, у меня поставлена на автозапуск). Ссылка на репозиторий: https://github.com/YaraRishar/chronominer

## Описание работы кликера
При запуске кликер открывает вебдрайвер - отдельный браузер (в данном случае Chrome For Testing), в котором открывается только вкладка Игровой. Если вы запустили кликер в первый раз, то спустя 5-30 секунд (или несколько минут) ожидания вы увидите страницу входа на catwar. **Важно:** данные, которые вы использовали для входа на вар, сохраняются на вашем компьютере. Местонахождение этих данных зависит от операционной системы, на Manjaro Linux (и, скорее всего, на всех Linux) они хранятся в папке selenium, она создаётся при запуске вебдрайвера там же, где лежит main.py. На всякий случай **НЕ ПЕРЕСЫЛАЙТЕ НИКОМУ ПАПКУ SELENIUM!** Если вы хотите поделиться с кем-то кликером, то скиньте им ссылку на гитхаб/паблик вк (см. первый абзац), где лежит версия точно без ваших данных.
Вебдрайвер контролируется командами из приложения main.py:
Если вы видите надпись "Загружается...", но вебдрайвер не открывается даже спустя несколько минут ожидания, напишите в ЛС паблика.
После символов ">>>" можно ввести команду, которая будет исполняться в вебдрайвере. Гайд ниже содержит описания команд и примеры использования, его можно всегда посмотреть в самом кликере командой help.

(Кликером также возможно пользоваться как текстовым клиентом вара, если вы хотите играть в игру про котов так, как будто она вышла в 1979)
## Установка
### Вариант А: воспользоваться готовым приложением
Этот вариант предпочтителен только в том случае, если вы *совсем* не хотите устанавливать Python и доверяете рандому из интернета (ака мне). Исходный код всё ещё лежит в архиве с приложением, папка source, так что желательно ознакомиться с тем, что вы запускаете - ко всем функциям есть комментарии.
####
Этот вариант временно недоступен для всех последних версий. Чтобы скачать приложение для версии 1.0, найдите вкладку "Releases" на гитхабе.
1. Скачайте архив chronoclicker_v1.0.zip
2. Распакуйте его с помощью 7zip или rar.
3. В распакованном архиве лежит main.exe - это и есть кликер (подробнее о его работе рассказано в предыдущем пункте).
4. Запустите main.exe, при этом должно появиться окно консоли с надписью "Загрузка..." и окно вебдрайвера.
5. После того, как вы ввели свои данные, опять же, не отправляйте папку с кликером никому, так как они могут храниться и в ней.
6. Зайдите в Игровую (в окне вебдрайвера).
7. В окно консоли после символов ">>>" введите любую команду из гайда ниже, например, "do Копать землю" без кавычек. Если ваш персонаж действительно начал копать, то вы успешно установили кликер. Если вебдрайвер крашнулся, то напишите в ЛС паблика со скрином ошибки/крашлогом.
### Вариант Б: скомпилировать код самостоятельно
Чуть более сложный вариант, но в какой-то мере гарантирует, что вы знаете, что делаете.
1. Установите последнюю версию Python с официального сайта (https://www.python.org/) с добавлением python в переменную PATH.
2. Откройте командную строку (win+R, в открывшемся окошке наберите cmd).
3. Кликер использует два пакета: selenium и selenium_stealth, первый обеспечивает работу вебдрайвера, второй прячет кликер от варовского античита. Для их установки в командной строке наберите py -m pip install selenium и py -m pip install selenium_stealth.
4. С гитхаба (https://github.com/YaraRishar/chronoclicker) скачайте исходный код (зелёная кнопка Code, в выпадающем меню Download ZIP).
5. В распакованном архиве лежит main.py, откройте его в Python IDLE (устанавливается вместе с Python) или в PyCharm (если есть).
6. Попробуйте запустить код: F5 или зелёный треугольник в правом верхнем углу. Если вы видите надпись "Загружается...", то вебдрайвер откроется через ~20 секунд при первом запуске. Далее следуйте инструкциям со скриншотами из варианта A.
7. Если же программа крашнулась, то скачайте chromedriver (https://googlechromelabs.github.io/chrome-for-testing/#stable), вероятно, нужная версия указана в таблице как chromedriver - win64.
8. В файле config.json найдите параметр "driver_path": "" и в кавычки вставьте путь к chromedriver.exe.
9. Теперь вебдрайвер должен запуститься. Если, несмотря на правильность пути, программа крашится, то напишите в ЛС паблика со скринами ошибки.
## Гайд по командам
Команды вводятся после символов ">>>" в консоли кликера, также их может быть несколько. В таком случае команды разделяются точкой с запятой, а все вместе они называются мультикомандой. В самом конце точку с запятой ставить не нужно.
Пример:
go Поляна для отдыха - Морозная поляна - Каменная гряда; jump 5 - 8; do Попить воды; go Морозная поляна - Поляна для отдыха - Лисья нора
Данная мультикоманда состоит из четырёх команд поменьше: go, jump, do, go. Они выполняются по очереди: как только ваш персонаж пройдёт по маршруту, данному первой командой go, он прыгнет на пятый ряд, восьмую клетку и начнёт действие питья. После окончания действия персонаж вернётся в спальную локацию (Лисья нора).
Также для мультикоманд могут быть созданы сокращения - синтаксис такой же, как обычно: alias name comm1; comm2 и так далее.
## Тернарные выражения
Тернарные выражение (от слова "три") - особые команды, которые состоят из трёх частей:

условие ? команда1 : команда2

При выполнении тернарного выражения сначала проверяется условие: если оно истинно, то выполняется команда1. В ином случае - команда2. Пример:

param бодрость < 90 ? do поспать : wait 5

Условием выступает команда param с аргументом "бодрость", она возвращает значение вашего параметра сна в процентах. Если возвращённое значение оказалось меньше 90%, то ваш персонаж совершит действие "поспать", а если больше, то подождёт 5 секунд, то есть, ничего не будет делать. Более сложный пример:

param бодрость < 40 ? pathfind 5 - 6; do поспать : do поплавать

Представьте, что вы находитесь на опасной плавательной локации. Когда ваш параметр сна опустится ниже 40%, то ваш персонаж по клеткам переместится на 6 клетку 5 ряда (где, предположим, есть переход на берег), и затем отоспится. Если же сон не упал ниже 40%, то будет совершено действие "поплавать".
Чтобы записать команду и повторять её бесконечно (пока вы не выключите кликер), можно сделать сокращение:

alias плывите_сосиски param бодрость < 40 ? pathfind 5 - 6; do поспать : do поплавать

Теперь, чтобы повторять команду бесконечно:

loop плывите_сосиски

Это сокращение, как и многие другие, уже добавлено в config.json.
##### wait начало_диапазона_секунд - конец_диапазона_секунд
Ничего не делает, просто ждёт. Используется в мультикомандах, например, чтобы отсрочить выполнение действия. Чтобы ждать точное количество секунд, начало и конец диапазона должны быть одинаковыми.
Пример:
wait 10 - 60
После ввода команды персонаж ничего не делает рандомное количество секунд, от 10 до 60.
Пример в мультикоманде:
do Принюхаться; wait 1800 - 1700; do Принюхаться
#####  go название_локации1 - название_локации2
Команда перехода, маршрут проходится один раз. Пример:
go Обжитая айн прогалина - Тёплые камни
##### patrol название_локации1 - название_локации2
Команда перехода, маршрут повторяется бесконечно (для маршрута из 3 локаций: 1 - 2 - 3 - 2 - 1 - 2 - 3 и так далее).
##### do действие1 - действие2
Команда для исполнения последовательности действий один раз. Пример:
do Принюхаться - Копать землю - Вылизаться
#### q
Большая красная кнопка. Выйти из кликера и закрыть вебдрайвер.
##### repeat действие1 - действие2
**КОМАНДА REPEAT УБРАНА ИЗ ВЕРСИИ 1.4!** Теперь вместо неё везде используется команда loop.

Пример ниже в новой версии будет выглядеть так:

loop do принюхаться - копать землю

legacy (потом уберу):
Команда для бесконечного повторения действий. Пример:
repeat Принюхаться - Копать землю
*Заметка:* если действие нюха недоступно на данный момент, то кликер пропустит его и выполнит копание. Но если на следующее повторение цикла нюх доступен, то он будет выполнен. То же самое верно и для переходов.
##### alias name comm
Команда для создания сокращений для часто используемых команд.
Пример:  
alias кач_актив patrol Морозная поляна - Поляна для отдыха  
В дальнейшем команда patrol Морозная поляна - Поляна для отдыха будет исполняться при вводе кач_актив. Все названия сокращений должны быть без пробелов. Сокращения сохраняются в файле config.json, их можно редактировать и напрямую в обычном блокноте, но придерживайтесь формата! Бэкап конфига можно всегда скачать на GitHub.
##### say сообщение
Написать сообщение в чат Игровой.
##### info
вывести информацию об окружающей среде (список котов на локации и доступных переходов убран из 1.0 из-за нестабильности)
##### char
вывести информацию о персонаже (т. е. имя, луны, должность, навыки). Из навыков показывает только УН, КУ, ПУ, БУ.
##### hist
Вывести историю действий.
##### clear_hist
Очистить историю.
##### help
Вывести этот документ либо ссылку на него, если README.md не найден в папке с кликером.
##### refresh
Перезагрузить страницу.
##### cancel
Отменить действие.
##### settings key - value
Команда для изменения настроек. Пример:
settings is_headless - True
##### rabbit_game
Команда для того, чтобы 5 раз поиграть в числа с Лапом.
##### inv
Вывести ссылки на картинки всех предметов во рту.
##### c row - column
(с работает как на кириллице, так и на латинице)

Вывести всю информацию о column клетке row ряда: что на ней лежит, куда ведёт переход, вся видимая информация про сидящего на ней кота. Пример:
c 6 - 10
##### balance
Вывести баланс кролей вашего персонажа.
##### bury item_image_id - level
Закопать предмет с айди картинки item_image_id на глубину level.
##### loop alias_name
Бесконечно повторять сокращение alias_name. О том, как добавить сокращение, читайте в команде alias.
#### pathfind row - column
(**Предупреждение**: так как кликер не знает, кто из котов на локации - вы и откуда ему начинать рассчитывать путь, то для работы этой команды вам нужно заполнить поле my_id в config.json. В противном случае команда работать не будет, но в остальном кликер будет работать. Если вы застрянете на опасной плавательной локации без pathfind, то вы можете утонуть! Поэтому следите за персонажем глазами либо качайте ПУ только в безопасках).

Найти кратчайший путь по клеткам от вашего местоположения до column клетки row ряда. Команда нужна в основном для тех локаций, где перемещение только по клеткам (опасные плавательные). Пример:

pathfind 3 - 3
#### find_item item_image_id1 - item_image_id2
Найти предмет по ID его изображения, рандомно переходя по локациям, когда нашёл, поднять. Откуда взять item_image_id: кликните ПКМ по предмету, выберите "Открыть изображение", посмотрите на ссылку на это изображение. Она будет выглядеть примерно так:

https://catwar.net/cw3/things/386.png (это ссылка на одну из вариаций звёздной пыли).

Число 386 - это тот ID изображения, который вам нужен. Пример:

find_item 385 - 386 - 387 - 388 - 389 - 390 - 392

Эта команда содержит ID всех звёздных пылей, так что ваш персонаж будет ходить по локациям, ища и поднимая пыль. У команды пока нет условия, при котором она заканчивается, так что придётся перезапускать кликер.
#### find_cat cat_name1 - cat_name2
То же самое, что и find_item, только без поднимания и с котами. Ищет кота по имени cat_name, рандомно переходя по локациям. Пример:

find_cat Латрис

После нахождения кота (или всех котов в списке) команда заканчивает выполняться и печатает, на какой локации и клетке сидит искомый кот.
#### findme
Печатает ваши координаты на поле (ряд и клетку). Работает только тогда, когда заполнен параметр my_id в config.json. Понадобится в будущем для тернарных мультикоманд.
#### param parameter_name
Выводит значение параметра parameter_name в процентах. Может использоваться как условие для тернарной команды. Пример:

param бодрость
#### skill skill_name
То же самое, что и с параметром. Выводит значение и уровень навыка, в тернарной команде возвращает "числитель" дроби навыка. Пример:

skill нюх
## Что делают настройки в config.json
##### long_break_chance
После каждого "круга" действий/каждого перехода есть шанс, что кликер прекратит работу на некоторое количество секунд, имитируя AFK. По умолчанию этот шанс равен 0.15, что соответствует 15%. Тогда 10% == 0.1, 95% == 0.95 и так далее. Если вы оставляете кликер на ночь, лучше не понижайте этот шанс до 0 или 0.01.
##### long_break_duration
Это и есть "некоторое количество секунд", указанное в предыдущем пункте. По умолчанию AFK-перерыв длится от 10 до 200 секунд, значение выбирается рандомно в этих границах.
##### short_break_duration
Этот параметр отвечает за перерыв после каждого действия, по умолчанию от 1 до 15 секунд. Теоретически его можно понизить, например, до 0-1, но во избежание бана лучше так не делать.
##### critical_sleep_pixels
Используется только для команды swim, которая скорее всего не работает в v0.1. Обозначает количество оставшихся зелёных пикселей в параметре сна, при котором персонаж прекращает плавать и идёт отсыпаться. 
##### is_headless
Запуск вебдрайвера без интерфейса. Если вы не хотите, чтобы окно браузера забивало память/мешало вам/етс, то вы можете изменить это значение на True и играть в вар с консоли.
##### driver_path
Путь к вашему chromedriver, если вам понадобилось его скачивать при установке. По умолчанию равен "".
##### max_waiting_time
Сколько вебдрайвер может ожидать загрузки страницы. Если у вас плохой интернет и загрузка занимает значительно больше 1 секунды, измените это значение на 3 или 5. Высокие значения вызывают замедление работы кликера!
